(function(){var t;t=function(){function t(){s().then(function(t){return g(t)},function(t){return g(t)})}var n,o,e,a,r,u,i,g,l,c,s,p,f,d,m,v,h,b,M,L,w;return a=1024,r=6,n=new google.maps.LatLng(33.582807,-117.727651),o=7,e=["rgba(255, 255, 255, 0)","rgba(249, 107, 107, 1)","rgba(249, 187, 107, 1)","rgba(249, 249, 107, 1)","rgba(107, 249, 107, 1)","rgba(107, 107, 249, 1)","rgba(171, 107, 249, 1)","rgba(249, 107, 249, 1)"],m=null,f=null,d=[],u=[],w=[],i=0,g=function(t){var n;return n={center:t,zoom:o||7,mapTypeId:google.maps.MapTypeId.ROADMAP},m=new google.maps.Map(document.getElementById("map-canvas"),n),google.maps.event.addListener(m,"idle",v)},s=function(){var t;return t=Q.defer(),navigator.geolocation?(console.log("Getting geolocation data..."),navigator.geolocation.getCurrentPosition(function(n){return t.resolve(new google.maps.LatLng(n.coords.latitude,n.coords.longitude))},function(o){return console.log("Error ("+o.code+"): "+o.message),t.reject(n)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})):(console.log("navigator.geolocation not available; using default location"),t.reject(n)),t.promise},v=function(){return b(),M(),c()},b=function(){var t,n,o,e,r,u,i,g,l,c,s,p,f,v;for(v=m.getBounds().getNorthEast().lat(),f=m.getBounds().getNorthEast().lng(),t=m.getBounds().getSouthWest().lat(),u=m.getBounds().getSouthWest().lng(),r=Math.abs(v-t),l=Math.abs(u-f),e=r/Math.sqrt(a),g=l/Math.sqrt(a),c=Math.ceil(Math.sqrt(a)),d=[],p=[],o=n=0,s=c;s>=0?s>=n:n>=s;o=s>=0?++n:--n)p.push(function(){var t,n,a;for(a=[],i=t=0,n=c;n>=0?n>=t:t>=n;i=n>=0?++t:--t)a.push(d.push(new google.maps.LatLng(v-o*e,u+i*g)));return a}());return p},M=function(){return i=Math.ceil(d.length/r)},c=function(t){var n,o,e,r;return null==t&&(t=0),n=t*(i+1),e=(t+1)*(i+1),n>a?(l(),L(),void h()):(o=new google.maps.ElevationService,r={locations:d.slice(n,e)},o.getElevationForLocations(r,function(n,o){return o===google.maps.ElevationStatus.OK?(u.push(n),c(t+1)):console.log("Error: "+o)}))},l=function(){return u=$.map(u,function(t){return t})},L=function(){var t,n,o,e;for(w=[],e=[],n=0,o=u.length;o>n;n++)t=u[n],e.push(t.elevation>0?w.push({location:t.location,weight:t.elevation}):void 0);return e},h=function(){var t;return f&&f.setMap(null),t={data:w,gradient:e,map:m,radius:p()},f=new google.maps.visualization.HeatmapLayer(t)},p=function(){return 6*m.getZoom()},t}(),$(document).ready(function(n){return function(){return null==n.app&&(n.app={}),n.app.map=new t}}(this))}).call(this);